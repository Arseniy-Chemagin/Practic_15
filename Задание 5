using System;

public interface IOперацииСчета
{
    void Внести(decimal сумма);
    bool Снять(decimal сумма);
}


public interface IOперацииПеревода
{
    bool ПеревестиНа(IOперацииСчета счетНазначения, decimal сумма);
}

public class БанковскийСчет : IOперацииСчета, IOперацииПеревода
{
    public decimal Баланс { get; private set; }
    public string НомерСчета { get; } 

    private static int _счетчикСчетов = 0;

    public БанковскийСчет(decimal начальныйБаланс = 0)
    {
        if (начальныйБаланс < 0)
        {
            throw new ArgumentException("Начальный баланс не может быть отрицательным.");
        }
        Баланс = начальныйБаланс;
        _счетчикСчетов++;
        НомерСчета = $"ACC{_счетчикСчетов:D4}"; 
        Console.WriteLine($"Создан счет {НомерСчета} с начальным балансом: {Баланс}");
    }

    public void Внести(decimal сумма)
    {
        if (сумма <= 0)
        {
            Console.WriteLine($"Ошибка: Сумма для внесения должна быть положительной. Текущий баланс счета {НомерСчета}: {Баланс}");
            return;
        }
        Баланс += сумма;
        Console.WriteLine($"На счет {НомерСчета} внесено {сумма:C}. Новый баланс: {Баланс:C}");
    }

    public bool Снять(decimal сумма)
    {
        if (сумма <= 0)
        {
            Console.WriteLine($"Ошибка: Сумма для снятия должна быть положительной. Текущий баланс счета {НомерСчета}: {Баланс}");
            return false;
        }
        if (Баланс >= сумма)
        {
            Баланс -= сумма;
            Console.WriteLine($"Со счета {НомерСчета} снято {сумма:C}. Новый баланс: {Баланс:C}");
            return true;
        }
        else
        {
            Console.WriteLine($"Ошибка: Недостаточно средств на счете {НомерСчета} для снятия {сумма:C}. Текущий баланс: {Баланс:C}");
            return false;
        }
    }

    
    public bool ПеревестиНа(IOперацииСчета счетНазначения, decimal сумма)
    {
        
        if (счетНазначения == null)
        {
            Console.WriteLine($"Ошибка: Счет назначения для перевода с {НомерСчета} не указан.");
            return false;
        }

        if (счетНазначения is БанковскийСчет целевойСчет && целевойСчет.НомерСчета == this.НомерСчета)
        {
            Console.WriteLine($"Ошибка: Нельзя перевести средства с {НомерСчета} на тот же самый счет.");
            return false;
        }

        if (сумма <= 0)
        {
            Console.WriteLine($"Ошибка: Сумма для перевода должна быть положительной. Текущий баланс счета {НомерСчета}: {Баланс}");
            return false;
        }

        if (this.Снять(сумма))
        {

            счетНазначения.Внести(сумма);
            Console.WriteLine($"Перевод {сумма:C} со счета {НомерСчета} успешно выполнен.");
            return true;
        }
        else
        {
            Console.WriteLine($"Ошибка: Перевод {сумма:C} со счета {НомерСчета} не удался из-за недостатка средств.");
            return false;
        }
    }

    public override string ToString()
    {
        return $"Счет {НомерСчета}, Баланс: {Баланс:C}";
    }
}

public class Программа
{
    public static void Main(string[] args)
    {
       
        БанковскийСчет счет1 = new БанковскийСчет(1000);
        БанковскийСчет счет2 = new БанковскийСчет(500);

        Console.WriteLine("\n--- Начальные балансы ---");
        Console.WriteLine(счет1);
        Console.WriteLine(счет2);
        Console.WriteLine("-------------------------\n");
       
        Console.WriteLine("Попытка перевести 200 руб. со Счета 1 на Счет 2...");
        счет1.ПеревестиНа(счет2, 200);

        Console.WriteLine("\n--- Балансы после первой попытки перевода ---");
        Console.WriteLine(счет1);
        Console.WriteLine(счет2);
        Console.WriteLine("---------------------------------------------\n");
 
        Console.WriteLine("Попытка перевести 1000 руб. со Счета 1 на Счет 2...");
        счет1.ПеревестиНа(счет2, 1000); 

        Console.WriteLine("\n--- Балансы после второй попытки перевода ---");
        Console.WriteLine(счет1);
        Console.WriteLine(счет2);
        Console.WriteLine("---------------------------------------------\n");

        Console.WriteLine("Попытка снять 10000 руб. со Счета 2...");
        счет2.Снять(10000); 

        Console.WriteLine("\n--- Балансы после попытки снятия ---");
        Console.WriteLine(счет1);
        Console.WriteLine(счет2);
        Console.WriteLine("-------------------------------------\n");
    }
}
